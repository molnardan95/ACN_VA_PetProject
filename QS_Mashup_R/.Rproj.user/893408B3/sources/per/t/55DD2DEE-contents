#install.packages("RSQLite")

library(DBI)
con <- dbConnect(RSQLite::SQLite(), "nba_player_data_R.db")

dbListTables(con)

con


player_data <- read.csv(file="../nba-players-stats/player_data.csv", header=TRUE, sep=",")
players <- read.csv("../nba-players-stats/Players.csv", header=TRUE, sep=",")
season_stats <- read.csv("../nba-players-stats/Seasons_Stats.csv", header=TRUE, sep=",")

dbWriteTable(con, "player_data", player_data)
dbWriteTable(con, "players", players)
dbWriteTable(con, "season_stats", season_stats)


dbReadTable(con, "players")
res <- dbSendQuery(con, "SELECT * FROM players WHERE height > 200")

dbFetch(res)

dbClearResult(res)

dbDisconnect(con)

